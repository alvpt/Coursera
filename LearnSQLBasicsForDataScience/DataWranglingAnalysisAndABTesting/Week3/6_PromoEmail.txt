--Create the right ubtable for recently viewed events using the view_item_events table.


SELECT
  users.id AS user_id,
  users.email_address,
  items.id AS item_id
FROM
  (
  SELECT
    user_id,
    item_id,
    event_time,
    ROW_NUMBER( ) OVER (PARTITION BY user_id ORDER BY event_time DESC)
      AS row_number,
  FROM
    dsv1069.view_item_events
  ) recent_views
  JOIN 
    dsv1069.users
  ON 
    users.id = recent_views.user_id
  JOIN 
    dv1069.items
  ON
    items.id = recent_views.item_id










  
  